<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.green.test.dao.BoardDAO">
  <select id="getBoardListDB" resultType="kr.green.test.vo.BoardVO">
    select * from board where valid = 'I'	<!-- value값이 0일때 자동으로 적용된다 -->
   <if test="type == 1"> and title like concat('%', #{search}, '%') </if>		<!-- concat : 값을 이어 붙이는 함수 -->
  	<if test="type == 2"> and contents like concat('%', #{search}, '%') </if>	<!-- like를 통해 검색 기능을 적용 -->
  	<if test="type == 3"> and writer like concat('%', #{search}, '%') </if>
    order by num desc
	 limit #{pageStart}, #{perPageNum}
  </select>
  
  <select id="getBoardDB" resultType="kr.green.test.vo.BoardVO">
    select * from board where num = #{num} and valid = 'I'
  </select>
  
	<insert id="boardRegisterDB">
		insert into board(title, writer, contents, file)
			values(#{title}, #{writer}, #{contents}, #{file})
	</insert>
	
	<update id="boardModifyDB">
		update board
		set title = #{title}, contents = #{contents}, file = #{file}
		where num = #{num} and valid = 'I'
	</update>
	
	<update id="boardDeleteDB">
		update board
		set valid = 'D'
		where num = #{num}
	</update>
	
	<select id="getTotalCount" resultType = "int">
		select count(*) from board where valid = 'I'
		<if test="type == 1"> and title like concat('%', #{search}, '%') </if>		<!-- concat : 값을 이어 붙이는 함수 -->
		<if test="type == 2"> and contents like concat('%', #{search}, '%') </if>	<!-- 페이지네이션에 적용하기 위해 페이지수를 다시 계산 -->
		<if test="type == 3"> and writer like concat('%', #{search}, '%') </if>
	</select>
</mapper>